syntax = "proto3";

package meme.posts;
option go_package = "github.com/materkov/meme9/api/posts";

// Posts service
service Posts {
  rpc Publish(PublishRequest) returns (PublishResponse);
  rpc GetByUsers(GetByUsersRequest) returns (GetByUsersResponse);
  rpc Get(GetPostRequest) returns (Post);
  rpc GetFeed(FeedRequest) returns (FeedResponse);
}

message PublishRequest {
  string text = 1;
}

message PublishResponse {
  string id = 1;
}

message GetByUsersRequest {
  string userId = 1;
}

message GetByUsersResponse {
  repeated Post posts = 1;
}

message GetPostRequest {
  string postId = 1;
}

message Post {
  string id = 1;
  string text = 2;
  string userId = 3;
  string userName = 4;
  string createdAt = 5; // RFC3339 format
  int32 likesCount = 6;
  bool isLiked = 7; // Whether the current user has liked this post
}

enum FeedType {
  FEED_TYPE_UNSPECIFIED = 0;
  FEED_TYPE_ALL = 1;
  FEED_TYPE_SUBSCRIPTIONS = 2;
}

message FeedRequest {
  FeedType type = 1;
}

message FeedResponse {
  repeated Post posts = 1;
}

